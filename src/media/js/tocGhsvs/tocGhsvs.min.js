(function(){"use strict";var e={};e.prototype={headingElementsArr:[],headingsLength:0,dropdownHTML:null,containerWithHeadings:null,config:{divTitle:"",divRole:"complementary",divAriaLabel:"",ulRole:"menu",ulAriaLabel:"Scroll to headline...",headings:"h1, h2, h3, h4, h5, h6",enumerateElements:"false",attachElement:"",divId:"scrollToHeadlineMenu",containerWithHeadings:"",hideIfNothingFound:"",moduleId:"",textLimit:30,fragmentLimit:30,ulId:"tocGhsvsUL-%s",ulClass:"tocGhsvsClass toc-list-group list-unstyled",liClass:"toc-list-group-item",indentChar:"",divClass:"div4Toc",forceIsItVisibleClasses:[]},setUpConfig:function(e){var t,i=this.config,n=void 0!==e.settings?e.settings.TocGhsvs:{};for(t in n)i.hasOwnProperty(t)&&"[DEFAULT]"!==n[t]&&(i[t]=n[t])},init:function(e){let t=null;if(this.setUpConfig(e),this.config.containerWithHeadings&&this.config.attachElement&&(this.containerWithHeadings=document.querySelector(this.config.containerWithHeadings),t=document.querySelector(this.config.attachElement)),null!==this.containerWithHeadings&&null!==t){this.getHeadings();var i=this.config.divId;if(null!==document.getElementById(i)){var n=document.getElementById(i);n.parentNode.removeChild(n)}var s=document.createElement("div"),o="";if(s.setAttribute("id",i),this.config.divRole&&s.setAttribute("role",this.config.divRole),this.config.divTitle&&s.setAttribute("title",this.config.divTitle),this.config.divAriaLabel&&s.setAttribute("aria-label",this.config.divAriaLabel),this.dropdownHTML="",this.headingsLength>0){let e="";this.config.ulId&&(e=' id="'+this.config.ulId.replace("%s",this.config.moduleId)+'"'),this.config.ulClass&&(e+=' class="'+this.config.ulClass+'"'),this.config.ulRole&&(e+=' role="'+this.config.ulRole+'"'),this.config.ulRole&&(e+=' role="'+this.config.ulRole+'"'),this.config.ulAriaLabel&&(e+=' aria-label="'+this.config.ulAriaLabel+'"'),this.dropdownHTML+="<ul"+e+">",o=this.getdropdownHTML(),this.dropdownHTML+=o+"</ul>"}else o="<p>Leider kein Inhaltsverzeichnis verfügbar</p>",this.dropdownHTML=o;o.length>0&&(s.className=this.config.divClass,t.insertBefore(s,t.firstChild),s.innerHTML=this.dropdownHTML),this.headingsLength||this.hideIfNothingFound()}else this.hideIfNothingFound()},hideIfNothingFound:function(){this.config.hideIfNothingFound&&null!==document.querySelector(this.config.hideIfNothingFound)&&this.addStyles(this.config.hideIfNothingFound+"{display:none !important;visibility: hidden !important")},normalizeName:function(e){return"string"==typeof e?e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""},getTextContent:function(e){function t(e,i){if(3===e.nodeType)i.push(e.data);else if(1===e.nodeType){var n=e.tagName.toLowerCase();if("img"===n||"area"===n)e.alt&&i.push(e.alt);else for(var s=e.firstChild;s;)t(s,i),s=s.nextSibling}}var i="",n=[];return t(e,n),n.length&&(i=n.join(" ")),i.length>this.config.textLimit&&(i=i.substring(0,this.config.textLimit-3)+"..."),i},getHeadings:function(){var e=this.config.headings;if("string"==typeof e&&0!==e.length){this.headingElementsArr=[];var t,i,n,s,o,l,r,a,h=this.containerWithHeadings.querySelectorAll(e);for(this.headingsLength=h.length,t=0,i=h.length;t<i;t+=1)n=h[t],s=n.getAttribute("role"),"string"==typeof s&&"presentation"===s||(r=this.isVisible(n,this.config.forceIsItVisibleClasses),n.getAttribute("id")?o=n.getAttribute("id"):(o=n.innerText.replace(/\s+/g,"_").toLowerCase().replace(/[&\/\\#,+()$~%.'"!:*?<>{}¹]/g,""),o.length>this.config.fragmentLimit&&(o=o.substring(0,this.config.fragmentLimit)),o=o.replace(/_+$/g,""),o+="_"+t),n.tabIndex="-1",n.setAttribute("id",o),n.setAttribute("class","isATocId "+n.className),l=this.getTextContent(n),a=n.tagName.toLowerCase(),this.headingElementsArr[t]={id:o,name:l,prefix:a,isItVisible:r})}},isVisible:function(e,t){function i(e,t){var n,s;if(9===e.nodeType)return!0;var o=document.defaultView?document.defaultView.getComputedStyle(e,null).getPropertyValue("display"):e.currentStyle.display,l=document.defaultView?document.defaultView.getComputedStyle(e,null).getPropertyValue("visibility"):e.currentStyle.visibility,r=e.getAttribute("hidden"),a=(e.getAttribute("aria-hidden"),e.getBoundingClientRect());if("none"===o||"hidden"===l||null!==r||a.height<4||a.width<4){for(n=0,s=t.length;n<s;n+=1)if(e.classList.contains(t[n]))return!0;return!1}return i(e.parentNode,t)}return i(e,t)},getdropdownHTML:function(){var e,t="",i=1,n="",s="",o="",l=0;for(e in this.headingElementsArr)if(l<this.headingsLength&&this.headingElementsArr[e].name){this.config.indentChar&&(s=this.headingElementsArr[e].prefix,n=this.config.indentChar.repeat(parseInt(s.substring(1)))+"| ");let r=' class="'+this.config.liClass+" po-"+this.headingElementsArr[e].prefix+'"';t+="<li"+r+">"+n,!1!==this.headingElementsArr[e].isItVisible&&(t+='<a tabindex="-1" href="#'+this.headingElementsArr[e].id+'">'),"false"!==this.config.enumerateElements?(o=i,i+=1):o=this.headingElementsArr[e].prefix,t+='<span class="listEntryPrefix">'+o+": </span>"+this.headingElementsArr[e].name,!1!==this.headingElementsArr[e].isItVisible&&(t+="</a>"),t+="</li>",l+=1}return t},addStyles:function(e){var t,i=document.createElement("style"),n=document.getElementsByTagName("head")[0];i.setAttribute("type","text/css"),n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:(t=document.createTextNode(e),i.appendChild(t))}},window.tocGhsvsInit=function(t){e.prototype.init(t)}})();